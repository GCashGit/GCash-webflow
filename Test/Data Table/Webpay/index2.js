const createItem=(item,templateElement)=>{const newItem=templateElement.cloneNode(true);newItem.classList.remove('hidden');const name=newItem.querySelector('.biller-item-title');const category=newItem.querySelector('[data-element="category"]');const payment_method=newItem.querySelector('.biller-item-services-title');if(name)name.textContent=item.name||item.Name;if(category)category.textContent=item.category;if(payment_method)payment_method.textContent=item.payment_method;return newItem};async function fetchPartners(url){try{const response=await fetch(url);return await response.json()}catch(error){console.log('fetchPartners(): ',error.message);return[]}}function renderItems(results_area,filter_data,template_element){results_area.textContent='';let newItems=filter_data.map(item=>createItem(item,template_element));newItems.map(item=>results_area.append(item));results_area.animate({opacity:[0,1]},300)}(async function(){const template_element=document.querySelector('.biller-result-card');const results_area=document.querySelector('.biller-result.billers_collection-list');const search_input=$('#field-2');const biller_card=$('.biller-list-item');const pagination_container=$('#pagination-area');const alpha_nav_regex=new RegExp('[^A-Za-z]');const index_header_container=$('.results-letter-index');const reset_all_btn=$('.biller-filter-reset-btn');let alpha_nav_btn=$('.alphabet-nav > .alphabet-nav_letter');let active_partner_type='';let active_letter='';let inputValue=search_input.val();let partnersData=await fetchPartners('https://gcashgit.github.io/GCash-webflow/Test/Data%20Table/Webpay/data.json');let filterd_items=[];let window_width=$(window).width();results_area.style.opacity='1';function displayFirstLetter(){const first_element=$('.biller-result.billers_collection-list > .biller-result-card').first();const element_text_content=first_element.find('.biller-item-title ').text();index_header_container.text(alpha_nav_regex.test(element_text_content.charAt(0))?'#':element_text_content.charAt(0))}function usePagination(data_arr){let arrowSVG=`<svg width="41" height="41" viewBox="0 0 41 41" fill="none" xmlns="http://www.w3.org/2000/svg"><circle cx="20.5" cy="20.4922" r="19" stroke="#025AE9" stroke-width="2"/><path d="M19 24L23 20L19 16" stroke="#025AE9" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/></svg>`;const pageSize=window_width>=1280?15:window_width<=1279&&window_width>=480?9:5;pagination_container.pagination({ulClassName:'pagination-list-wrapper',dataSource:data_arr,prevText:arrowSVG,nextText:arrowSVG,showNavigator:true,formatNavigator:'Results: <%= rangeStart %> - <%= rangeEnd %> of <%= totalNumber %>',pageSize,pageRange:1,callback:(data,pagination)=>{renderItems(results_area,data,template_element);displayFirstLetter()}})}function hasItemStartingWithLetter(arr,letter){if(alpha_nav_regex.test(letter)){for(let i=0;i<arr.length;i++)if(alpha_nav_regex.test(arr[i].name.charAt(0)))return true}else{for(let i=0;i<arr.length;i++)if(arr[i].name.toLowerCase().startsWith(letter.toLowerCase()))return true}return false}function disableLetter(data_arr){alpha_nav_btn.each(function(index){if(!hasItemStartingWithLetter(data_arr,$(this).data('letter'))){$(this).addClass('disabled')}else{$(this).removeClass('disabled')}})}function displayNoResult(isDisplayed,searchValue=" "){let no_result_container=$('.no-results-wrapper');let search_result=$('.no-results-wrapper > .no-results-label .result');let results_wrapper=$('.results-wrapper');let letter_index_header=$('.results-letter-index');let card_view_btns=$('.biller-view-options');if(isDisplayed){no_result_container.removeClass('disabled');pagination_container.hide();results_wrapper.hide();letter_index_header.hide();search_result.text(searchValue);card_view_btns.addClass('no-result')}else{no_result_container.addClass('disabled');pagination_container.show();results_wrapper.show();card_view_btns.removeClass('no-result');if(window_width<479)letter_index_header.show()}}function handleResetBtn(){if(active_partner_type.length>0||active_letter.length>0)reset_all_btn.removeClass('no-filters');else reset_all_btn.addClass('no-filters')}search_input.on("input",function(){inputValue=$(this).val().toLowerCase();let result_msg='';if(active_partner_type.length>0&&active_letter.length>0){if(alpha_nav_regex.test(active_letter)){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase());disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue)&&item.category.toLowerCase()===active_partner_type.toLowerCase()&&alpha_nav_regex.test(item.name.charAt(0)));pagination_container.pagination('destroy');usePagination(filterd_items)}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase());disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue)&&item.category.toLowerCase()===active_partner_type.toLowerCase()&&item.name.toLowerCase().startsWith(active_letter));pagination_container.pagination('destroy');usePagination(filterd_items)}displayNoResult(false);result_msg=`Category: ${active_partner_type}, Letter: ${active_letter.toUpperCase()} and ${inputValue}`}else if(active_partner_type.length>0&&active_letter.length==0){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue)&&item.category.toLowerCase()===active_partner_type.toLowerCase());pagination_container.pagination('destroy');usePagination(filterd_items);disableLetter(filterd_items);displayNoResult(false);result_msg=`Category: ${active_partner_type} and ${inputValue}`}else if(active_partner_type.length==0&&active_letter.length>0){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue));disableLetter(filterd_items);if(alpha_nav_regex.test(active_letter)){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue)&&alpha_nav_regex.test(item.name.charAt(0)));pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue)&&item.name.toLowerCase().startsWith(active_letter));pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}result_msg=`Letter: ${active_letter.toUpperCase()} and ${inputValue}`}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().includes(inputValue));pagination_container.pagination('destroy');usePagination(filterd_items);disableLetter(filterd_items);displayNoResult(false);result_msg=inputValue}if(filterd_items.length==0){usePagination(filterd_items);disableLetter(filterd_items);displayNoResult(true,result_msg)}});biller_card.on("click",function(){let result_msg='';$('.biller_dropdown-current').text($(this).children('.biller-label').text());active_partner_type=$(this).children('.biller-label').text();if(active_partner_type.toLowerCase()==='all categories'){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name));disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(active_letter));pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false);active_partner_type=''}else{if(active_letter.length>0){if(alpha_nav_regex.test(active_letter)){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase()&&alpha_nav_regex.test(item.name.charAt(0)))}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase());disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(active_letter)&&item.category.toLowerCase()===active_partner_type.toLowerCase());pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}result_msg=`Category: ${active_partner_type}, Starting Letter: ${active_letter}`}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase());disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(inputValue)&&item.category.toLowerCase()===active_partner_type.toLowerCase());pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false);result_msg=`Category: ${active_partner_type}`}if(filterd_items.length==0){displayNoResult(true,result_msg)}});alpha_nav_btn.on("click",function(){active_letter=$(this).data('letter');let result_msg='';if(active_partner_type.length>0){if(alpha_nav_regex.test(active_letter)){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase()&&alpha_nav_regex.test(item.name.charAt(0)))}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.category.toLowerCase()===active_partner_type.toLowerCase());disableLetter(filterd_items);filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(active_letter)&&item.category.toLowerCase()===active_partner_type.toLowerCase());pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}result_msg=`Category: ${active_partner_type}, Starting Letter: ${active_letter}`}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(inputValue));disableLetter(filterd_items);if(alpha_nav_regex.test(active_letter)){filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(inputValue)&&alpha_nav_regex.test(item.name.charAt(0)));pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}else{filterd_items=partnersData.sort((a,b)=>a.name.localeCompare(b.name)).filter(item=>item.name.toLowerCase().startsWith(inputValue)&&item.name.toLowerCase().startsWith(active_letter));pagination_container.pagination('destroy');usePagination(filterd_items);displayNoResult(false)}result_msg=`Starting Letter: ${active_letter}`}if(filterd_items.length==0){displayNoResult(true,result_msg)}});reset_all_btn.on("click",function(){search_input.val("");search_input.trigger("input");active_letter='';active_partner_type='';handleResetBtn()});function handleResize(){window_width=$(window).width();usePagination(partnersData)}handleResize();$(window).resize(handleResize)})();
